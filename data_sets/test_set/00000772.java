public class OnFinish implements Runnable { protected boolean mSuccess; protected String mMessage; protected DialogFragment mDialog = null; protected OnFinish mOnFinish; protected Handler mHandler; public OnFinish() { } public OnFinish(Handler handler) { mOnFinish = null; mHandler = handler; } public OnFinish(OnFinish finish, Handler handler) { mOnFinish = finish; mHandler = handler; } public OnFinish(OnFinish finish) { mOnFinish = finish; mHandler = null; } public void setResult(boolean success, String message) { mSuccess = success; mMessage = message; } public void setResult(boolean success, DialogFragment dialogFragment) { mSuccess = success; mDialog = dialogFragment; } public void setResult(boolean success) { mSuccess = success; } public void run() { if ( mOnFinish != null ) { if (mDialog != null) { mOnFinish.setResult(mSuccess, mDialog); } else { mOnFinish.setResult(mSuccess, mMessage); } if ( mHandler != null ) { mHandler.post(mOnFinish); } else { mOnFinish.run(); } } } protected void displayMessage(AppCompatActivity ctx) { if (ctx == null) { return; } displayMessage(ctx, ctx.getSupportFragmentManager()); } protected void displayMessage(Context ctx, FragmentManager fm) { if (ctx != null && mMessage != null && mMessage.length() > 0) { Toast.makeText(ctx, mMessage, Toast.LENGTH_LONG).show(); } else if (fm != null && mDialog != null) { mDialog.show(fm, "message"); } } }