public class TestFailAggregator extends BaseOperation implements Aggregator { private static final long serialVersionUID = 1L; private final int fail; public TestFailAggregator( Fields fields, int fail ) { super( fields ); this.fail = fail; } public void start( FlowProcess flowProcess, AggregatorCall aggregatorCall ) { if( fail == 0 ) throw new RuntimeException( "failed" ); } public void aggregate( FlowProcess flowProcess, AggregatorCall aggregatorCall ) { if( fail == 1 ) throw new RuntimeException( "failed" ); } public void complete( FlowProcess flowProcess, AggregatorCall aggregatorCall ) { if( fail == 2 ) throw new RuntimeException( "failed" ); } @Override public boolean equals( Object object ) { if( this == object ) return true; if( !( object instanceof TestFailAggregator ) ) return false; if( !super.equals( object ) ) return false; TestFailAggregator that = (TestFailAggregator) object; if( fail != that.fail ) return false; return true; } @Override public int hashCode() { int result = super.hashCode(); result = 31 * result + fail; return result; } }