public class ValueIndexTupleSerializer extends IndexTupleSerializer<ValueIndexTuple> { public ValueIndexTupleSerializer( TupleSerialization.SerializationElementWriter elementWriter ) { super( elementWriter ); typeMap = elementWriter.getTupleSerialization().getMaskedValueTypeMap(); if( elementWriter.getTupleSerialization().areTypesRequired() ) { if( typeMap == null || typeMap.isEmpty() ) throw new IllegalStateException( "types are required to perform serialization" ); } } }