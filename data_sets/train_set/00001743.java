public class ConfigurationSetter implements ConfigDef.Setter { private final Configuration conf; public ConfigurationSetter( Configuration conf ) { this.conf = conf; } @Override public String set( String key, String value ) { String oldValue = get( key ); conf.set( key, value ); return oldValue; } @Override public String update( String key, String value ) { String oldValue = get( key ); if( oldValue == null ) conf.set( key, value ); else if( !oldValue.contains( value ) ) conf.set( key, oldValue + "," + value ); return oldValue; } @Override public String get( String key ) { String value = conf.get( key ); if( value == null || value.isEmpty() ) return null; return value; } }