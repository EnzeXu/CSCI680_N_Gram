public class CoGroupAroundCoGroupGraph extends FlowElementGraph { public CoGroupAroundCoGroupGraph() { Map sources = new HashMap(); NonTap source10 = new NonTap( "source10", new Fields( "offset", "line" ) ); NonTap source20 = new NonTap( "source20", new Fields( "offset", "line" ) ); sources.put( "source20", source20 ); sources.put( "source101", source10 ); sources.put( "source102", source10 ); Map sinks = new HashMap(); sinks.put( "sink", new NonTap( "sink", new Fields( "offset", "line" ) ) ); Pipe pipeNum20 = new Pipe( "source20" ); Pipe pipeNum101 = new Pipe( "source101" ); Pipe pipeNum102 = new Pipe( "source102" ); Pipe splice1 = new CoGroup( pipeNum20, new Fields( "num" ), pipeNum101, new Fields( "num" ), new Fields( "num1", "num2" ) ); Pipe splice2 = new CoGroup( splice1, new Fields( "num1" ), pipeNum102, new Fields( "num" ), new Fields( "num1", "num2", "num3" ) ); splice2 = new Each( splice2, new Identity() ); splice2 = new Pipe( "sink", splice2 ); initialize( sources, sinks, splice2 ); } }