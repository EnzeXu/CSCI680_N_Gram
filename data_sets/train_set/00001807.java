public class BalanceSameSourceStreamedAccumulatedExpression extends RuleExpression { private static final FlowElementExpression SHARED_TAP = new FlowElementExpression( Tap.class, TypeExpression.Topo.SplitOnly ); public static final FlowElementExpression SHARED_HASHJOIN_STREAMED = new FlowElementExpression( HashJoin.class ); public static final FlowElementExpression SHARED_HASHJOIN_ACCUMULATED = new FlowElementExpression( HashJoin.class ); public BalanceSameSourceStreamedAccumulatedExpression() { super( new SyncPipeExpressionGraph(), new ExpressionGraph() .arc( SHARED_TAP, PathScopeExpression.NON_BLOCKING, SHARED_HASHJOIN_STREAMED ) .arc( SHARED_TAP, PathScopeExpression.BLOCKING, SHARED_HASHJOIN_ACCUMULATED ) .arc( SHARED_HASHJOIN_STREAMED, PathScopeExpression.NON_BLOCKING, SHARED_HASHJOIN_ACCUMULATED ), new ExpressionGraph() .arc( new FlowElementExpression( ElementCapture.Primary, Pipe.class ), PathScopeExpression.NON_BLOCKING, new FlowElementExpression( ElementCapture.Secondary, HashJoin.class ) ) ); } }