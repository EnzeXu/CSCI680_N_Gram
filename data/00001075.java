public class SelfCoGroupGraph extends FlowElementGraph { public SelfCoGroupGraph ( ) { Map sources = new HashMap ( ) ; NonTap sourceLower = new NonTap ( "lower" , new Fields ( "offset" , "line" ) ) ; sources . put ( "lower" , sourceLower ) ; Map sinks = new HashMap ( ) ; sinks . put ( "sink" , new NonTap ( "sink" , new Fields ( "offset" , "line" ) ) ) ; Function splitter = new RegexSplitter ( new Fields ( "num" , "char" ) , " " ) ; Pipe lower = new Pipe ( "lower" ) ; Pipe pipeLower = new Each ( new Pipe ( "lhs" , lower ) , new Fields ( "line" ) , splitter ) ; Pipe pipeUpper = new Each ( new Pipe ( "rhs" , lower ) , new Fields ( "line" ) , splitter ) ; Pipe splice = new CoGroup ( "sink" , pipeLower , new Fields ( "num" ) , pipeUpper , new Fields ( "num" ) , Fields . size ( 4 ) ) ; initialize ( sources , sinks , splice ) ; } }