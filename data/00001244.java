public class TupleListCollector extends TupleEntryCollector implements Iterable<Tuple> { private final LinkedList<Tuple> tuples = new LinkedList<Tuple>(); private boolean copyTupleOnCollect = false; public TupleListCollector( Fields fields, Tuple... tuple ) { super( fields ); collect( tuple ); } public TupleListCollector( Fields fields, boolean copyTupleOnCollect ) { super( fields ); this.copyTupleOnCollect = copyTupleOnCollect; } private void collect( Tuple... tuples ) { for( Tuple tuple : tuples ) add( tuple ); } protected void collect( TupleEntry tupleEntry ) { if( copyTupleOnCollect ) tuples.add( tupleEntry.getTupleCopy() ); else tuples.add( tupleEntry.getTuple() ); } public boolean isEmpty() { return tuples.isEmpty(); } public void clear() { tuples.clear(); } public int size() { return tuples.size(); } public Iterator<Tuple> iterator() { return tuples.iterator(); } public Iterator<TupleEntry> entryIterator() { return new TupleEntryChainIterator( tupleEntry.getFields(), tuples.iterator() ); } }