public class TestSourceStage<Outgoing> extends Stage<Void, Outgoing> { List<Outgoing> values = new ArrayList<Outgoing>(); public TestSourceStage( Collection<Outgoing> collection ) { values.addAll( collection ); } @Override public void receive( Duct previous, int ordinal, Void value ) { next.start( this ); for( Outgoing item : values ) next.receive( this, 0, item ); next.complete( this ); } }