public class HadoopFailScheme extends TextLine { boolean sourceFired = false ; boolean sinkFired = false ; public HadoopFailScheme ( ) { } public HadoopFailScheme ( Fields sourceFields ) { super ( sourceFields ) ; } @ Override public boolean source ( FlowProcess < ? extends Configuration > flowProcess , SourceCall < Object [ ] , RecordReader > sourceCall ) throws IOException { if ( !sourceFired ) { sourceFired = true ; throw new TapException ( "fail" , new Tuple ( "bad data" ) ) ; } return super . source ( flowProcess , sourceCall ) ; } @ Override public void sink ( FlowProcess < ? extends Configuration > flowProcess , SinkCall < Object [ ] , OutputCollector > sinkCall ) throws IOException { if ( !sinkFired ) { sinkFired = true ; throw new TapException ( "fail" , new Tuple ( "bad data" ) ) ; } super . sink ( flowProcess , sinkCall ) ; } }