public class HadoopTupleEntrySchemeCollector extends TupleEntrySchemeCollector < Configuration , OutputCollector > { private MeasuredOutputCollector measuredOutputCollector ; public HadoopTupleEntrySchemeCollector ( FlowProcess < ? extends Configuration > flowProcess , Tap < Configuration , RecordReader , OutputCollector > tap ) throws IOException { super ( flowProcess , tap , tap . getScheme ( ) , makeCollector ( flowProcess , tap , null ) , tap . getIdentifier ( ) ) ; } public HadoopTupleEntrySchemeCollector ( FlowProcess < ? extends Configuration > flowProcess , Tap < Configuration , RecordReader , OutputCollector > tap , OutputCollector outputCollector ) throws IOException { super ( flowProcess , tap , tap . getScheme ( ) , makeCollector ( flowProcess , tap , outputCollector ) , tap . getIdentifier ( ) ) ; } private static OutputCollector makeCollector ( FlowProcess < ? extends Configuration > flowProcess , Tap < Configuration , RecordReader , OutputCollector > tap , OutputCollector outputCollector ) throws IOException { if ( outputCollector != null ) return outputCollector ; return new TapOutputCollector ( flowProcess , tap ) ; } @ Override protected OutputCollector < ? , ? > wrapOutput ( OutputCollector outputCollector ) { if ( measuredOutputCollector == null ) measuredOutputCollector = new MeasuredOutputCollector ( getFlowProcess ( ) , SliceCounters . Write_Duration ) ; measuredOutputCollector . setOutputCollector ( super . wrapOutput ( outputCollector ) ) ; return measuredOutputCollector ; } }