public class Rename extends SubAssembly { @ConstructorProperties({"previous", "fromFields", "toFields"}) public Rename( Pipe previous, Fields fromFields, Fields toFields ) { super( previous ); if( fromFields == null ) throw new IllegalArgumentException( "fromFields may not be null" ); if( toFields == null ) throw new IllegalArgumentException( "toFields may not be null" ); if( fromFields.isDefined() && fromFields.size() != toFields.size() ) throw new IllegalArgumentException( "fields arguments must be same size, from: " + fromFields.printVerbose() + " to: " + toFields.printVerbose() ); if( !toFields.isDefined() ) throw new IllegalArgumentException( "toFields must define field names: " + toFields.printVerbose() ); setTails( new Each( previous, fromFields, new Identity( toFields ), Fields.SWAP ) ); } }