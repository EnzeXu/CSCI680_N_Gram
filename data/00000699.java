public class FinalKeyTest { private Random mRand; @Before public void setUp() throws Exception { mRand = new Random(); } @Test public void testNativeAndroid() throws IOException { testNativeFinalKey(5); testNativeFinalKey(6); } private void testNativeFinalKey(int rounds) throws IOException { byte[] seed = new byte[32]; byte[] key = new byte[32]; byte[] nativeKey; byte[] androidKey; mRand.nextBytes(seed); mRand.nextBytes(key); AndroidFinalKey aKey = new AndroidFinalKey(); androidKey = aKey.transformMasterKey(seed, key, rounds); NativeFinalKey nKey = new NativeFinalKey(); nativeKey = nKey.transformMasterKey(seed, key, rounds); assertArrayEquals("Does not match", androidKey, nativeKey); } }