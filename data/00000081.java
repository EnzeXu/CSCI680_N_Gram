public class TapStream { private final List < TapOperation > ops ; public TapStream ( ) { ops = new LinkedList < TapOperation > ( ) ; } public void cancel ( ) { for ( TapOperation op : ops ) { op . cancel ( ) ; } } public boolean isCompleted ( ) { for ( TapOperation op : ops ) { if ( !op . getState ( ) . equals ( OperationState . COMPLETE ) ) { return false ; } } return true ; } public boolean isCancelled ( ) { for ( TapOperation op : ops ) { if ( !op . isCancelled ( ) ) { return false ; } } return true ; } public boolean hasErrored ( ) { for ( TapOperation op : ops ) { if ( !op . hasErrored ( ) ) { return false ; } } return true ; } public void addOp ( TapOperation op ) { ops . add ( op ) ; } }