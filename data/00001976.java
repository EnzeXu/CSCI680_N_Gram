public class KeyIndexTupleSerializer extends IndexTupleSerializer<KeyIndexTuple> { public KeyIndexTupleSerializer( TupleSerialization.SerializationElementWriter elementWriter ) { super( elementWriter ); typeMap = elementWriter.getTupleSerialization().getKeyTypeMap(); if( elementWriter.getTupleSerialization().areTypesRequired() ) { if( typeMap == null || typeMap.isEmpty() ) throw new IllegalStateException( "types are required to perform serialization" ); } } }