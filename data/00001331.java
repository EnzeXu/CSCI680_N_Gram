public class ReplaceGraphTransformer extends MutateGraphTransformer { public ReplaceGraphTransformer ( ExpressionGraph filter ) { super ( filter ) ; } public ReplaceGraphTransformer ( GraphTransformer graphTransformer , ExpressionGraph filter ) { super ( graphTransformer , filter ) ; } @ Override protected boolean transformGraphInPlaceUsing ( Transformed < ElementGraph > transformed , ElementGraph graph , Match match ) { Set < FlowElement > replace = match . getCapturedElements ( ElementCapture . Primary ) ; Set < FlowElement > replaceWith = match . getCapturedElements ( ElementCapture . Secondary ) ; if ( replace . isEmpty ( ) || replaceWith . isEmpty ( ) ) return false ; if ( replace . size ( ) != 1 ) throw new IllegalStateException ( "too many captured elements" ) ; if ( replaceWith . size ( ) != 1 ) throw new IllegalStateException ( "too many target elements" ) ; ElementGraphs . replaceElementWith ( graph , Util . getFirst ( replace ) , Util . getFirst ( replaceWith ) ) ; return true ; } }