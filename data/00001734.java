public class TapCollectorPlatformTest extends PlatformTestCase { public TapCollectorPlatformTest ( ) { } @ Test public void testTapCollectorText ( ) throws IOException { Tap tap = getPlatform ( ) . getTextFile ( getOutputPath ( "tapcollectortext" ) ) ; runTest ( tap ) ; } @ Test public void testTapCollectorSequence ( ) throws IOException { Tap tap = getPlatform ( ) . getDelimitedFile ( new Fields ( "string" , "value" , "number" ) , "\t" , getOutputPath ( "tapcollectorseq" ) ) ; runTest ( tap ) ; } private void runTest ( Tap tap ) throws IOException { TupleEntryCollector collector = tap . openForWrite ( getPlatform ( ) . getFlowProcess ( ) ) ; for ( int i = 0 ; i < 100 ; i++ ) collector . add ( new Tuple ( "string" , "" + i , i ) ) ; collector . close ( ) ; TupleEntryIterator iterator = tap . openForRead ( getPlatform ( ) . getFlowProcess ( ) ) ; int count = 0 ; while ( iterator . hasNext ( ) ) { iterator . next ( ) ; count++ ; } iterator . close ( ) ; assertEquals ( "wrong size" , 100 , count ) ; } }