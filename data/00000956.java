public class MyInputStream extends InputStream { private int cursor; private int mark; public MyInputStream() { cursor = 0; mark = 0; } public int read() throws IOException { if (cursor >= size) { return -1; } int result = getUnsignedByte0(cursor); cursor++; return result; } public int read(byte[] arr, int offset, int length) { if ((offset + length) > arr.length) { length = arr.length - offset; } int maxLength = size - cursor; if (length > maxLength) { length = maxLength; } System.arraycopy(bytes, cursor + start, arr, offset, length); cursor += length; return length; } public int available() { return size - cursor; } public void mark(int reserve) { mark = cursor; } public void reset() { cursor = mark; } public boolean markSupported() { return true; } }