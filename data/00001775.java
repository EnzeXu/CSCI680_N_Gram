public class IndexTupleSerializer < T extends IndexTuple > extends BaseSerializer < T > { protected Map < Integer , Class [ ] > typeMap ; public IndexTupleSerializer ( TupleSerialization . SerializationElementWriter elementWriter ) { super ( elementWriter ) ; } public void serialize ( T tuple ) throws IOException { outputStream . writeIntInternal ( tuple . getIndex ( ) ) ; Class [ ] types = getTypesFor ( tuple . getIndex ( ) ) ; if ( types == null ) outputStream . writeUnTyped ( tuple . getTuple ( ) ) ; else outputStream . writeTyped ( types , tuple . getTuple ( ) ) ; } protected Class [ ] getTypesFor ( int ordinal ) { if ( typeMap == null ) return null ; return typeMap . get ( ordinal ) ; } }