public class HadoopTupleMapFactory implements TupleMapFactory<Configuration> { private int capacity; private float loadFactor; private int mapThreshold; private int listThreshold; @Override public void initialize( FlowProcess<? extends Configuration> flowProcess ) { capacity = SpillableTupleMap.getMapCapacity( flowProcess, SpillableProps.defaultMapInitialCapacity ); loadFactor = SpillableTupleMap.getMapLoadFactor( flowProcess, SpillableProps.defaultMapLoadFactor ); mapThreshold = SpillableTupleMap.getMapThreshold( flowProcess, SpillableProps.defaultMapThreshold ); listThreshold = SpillableTupleList.getThreshold( flowProcess, SpillableProps.defaultListThreshold ); } @Override public Map<Tuple, Collection<Tuple>> create( FlowProcess<? extends Configuration> flowProcess ) { return new HadoopSpillableTupleMap( capacity, loadFactor, mapThreshold, listThreshold, flowProcess ); } }