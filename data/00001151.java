public class DistCacheTap extends BaseDistCacheTap { public static final String CASCADING_LOCAL_RESOURCES = "cascading.resources.local."; public static final String CASCADING_REMOTE_RESOURCES = "cascading.resources.remote."; public DistCacheTap( Tap<Configuration, RecordReader, OutputCollector> original ) { super( original ); } @Override protected Path[] getLocalCacheFiles( FlowProcess<? extends Configuration> flowProcess ) throws IOException { String key = CASCADING_REMOTE_RESOURCES + Tap.id( this ); String property = flowProcess.getStringProperty( key ); if( property == null ) throw new TapException( "unable to find local resources property for: " + key ); String[] split = property.split( "," ); Path[] paths = new Path[ split.length ]; for( int i = 0; i < split.length; i++ ) paths[ i ] = new Path( split[ i ] ); return paths; } @Override protected void addLocalCacheFiles( Configuration conf, URI uri ) { String key = CASCADING_LOCAL_RESOURCES + Tap.id( this ); Collection<String> resources = conf.getStringCollection( key ); if( resources == null ) resources = new ArrayList<>(); resources.add( uri.toString() ); conf.setStrings( key, resources.toArray( new String[ resources.size() ] ) ); } }