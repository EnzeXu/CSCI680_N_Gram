public class HashesTest extends CascadingTestCase { @ Test public void testBase64URL ( ) { Fields hash = new Fields ( "hash" , String . class ) ; Base64URLHashFunction function = new Base64URLHashFunction ( hash , pre - > "foo" + pre , post - > post . insert ( 0 , "prefix-" ) ) ; Tuple [ ] arguments = new Tuple [ ] { new Tuple ( "foo" ) , new Tuple ( "foo" ) , new Tuple ( "foo" , "bar" ) , } ; TupleListCollector tuples = invokeFunction ( function , arguments , hash ) ; Iterator < Tuple > iterator = tuples . iterator ( ) ; Tuple first = iterator . next ( ) ; assertEquals ( first , iterator . next ( ) ) ; assertNotSame ( first , iterator . next ( ) ) ; } @ Test public void testBase10 ( ) { Fields hash = new Fields ( "hash" , String . class ) ; Base10HashFunction function = new Base10HashFunction ( hash ) ; Tuple [ ] arguments = new Tuple [ ] { new Tuple ( "foo" ) , new Tuple ( "foo" ) , new Tuple ( "foo" , "bar" ) , } ; TupleListCollector tuples = invokeFunction ( function , arguments , hash ) ; Iterator < Tuple > iterator = tuples . iterator ( ) ; Tuple first = iterator . next ( ) ; assertEquals ( first , iterator . next ( ) ) ; assertNotSame ( first , iterator . next ( ) ) ; } }