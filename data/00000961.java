public class TezCoGroupClosure extends HadoopCoGroupClosure { public TezCoGroupClosure ( FlowProcess flowProcess , int numSelfJoins , Fields [ ] groupingFields , Fields [ ] valueFields ) { super ( flowProcess , numSelfJoins , groupingFields , valueFields ) ; } protected void build ( ) { clearGroups ( ) ; for ( int pos = 0 ; pos < values . length ; pos++ ) ( ( ResettableCollection ) collections [ pos ] ) . reset ( values [ pos ] ) ; if ( numSelfJoins != 0 ) { Iterator < Tuple > iterator = collections [ 0 ] . iterator ( ) ; while ( iterator . hasNext ( ) ) iterator . next ( ) ; } } @ Override protected Collection < Tuple > createTupleCollection ( Fields joinField ) { return new LazySpillableTupleCollection ( super . createTupleCollection ( joinField ) ) ; } }