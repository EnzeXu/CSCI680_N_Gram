public class HadoopTupleCollectionFactory implements TupleCollectionFactory<Configuration> { private int spillThreshold; private CompressionCodec codec; private TupleSerialization tupleSerialization; @Override public void initialize( FlowProcess<? extends Configuration> flowProcess ) { this.spillThreshold = getThreshold( flowProcess, defaultListThreshold ); this.codec = HadoopSpillableTupleList.getCodec( flowProcess, HadoopSpillableTupleList.defaultCodecs ); this.tupleSerialization = new TupleSerialization( flowProcess ); } @Override public Collection<Tuple> create( FlowProcess<? extends Configuration> flowProcess ) { return new HadoopSpillableTupleList( spillThreshold, tupleSerialization, codec ); } }