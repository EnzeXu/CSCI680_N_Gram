public class JSONHadoopSerialization extends Configured implements Serialization { ObjectMapper mapper = new IonObjectMapper ( ) ; @ Override public boolean accept ( Class type ) { return JsonNode . class . isAssignableFrom ( type ) ; } @ Override public Serializer getSerializer ( Class type ) { return new Serializer ( ) { private OutputStream out ; @ Override public void open ( OutputStream out ) { this . out = out ; } @ Override public void serialize ( Object object ) throws IOException { mapper . writeValue ( out , object ) ; } @ Override public void close ( ) throws IOException { this . out . close ( ) ; this . out = null ; } } ; } @ Override public Deserializer getDeserializer ( Class type ) { return new Deserializer ( ) { private InputStream in ; @ Override public void open ( InputStream in ) { this . in = in ; } @ Override public Object deserialize ( Object object ) throws IOException { return mapper . readTree ( in ) ; } @ Override public void close ( ) throws IOException { this . in . close ( ) ; this . in = null ; } } ; } }