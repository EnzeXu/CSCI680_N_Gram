public class StreamedAccumulatedTapsHashJoinExpressionGraph extends ExpressionGraph { public StreamedAccumulatedTapsHashJoinExpressionGraph ( ) { super ( SearchOrder . Depth ) ; FlowElementExpression split = new FlowElementExpression ( Tap . class ) ; ElementExpression join = new FlowElementExpression ( HashJoin . class ) ; ElementExpression merge = new FlowElementExpression ( Merge . class ) ; ElementExpression sink = or ( ElementCapture . Secondary , new FlowElementExpression ( Tap . class ) , new FlowElementExpression ( Group . class ) ) ; this . arc ( new FlowElementExpression ( ElementCapture . Primary , Tap . class ) , PathScopeExpression . ALL_NON_BLOCKING , join ) ; this . arc ( split , PathScopeExpression . ALL_BLOCKING , join ) ; this . arc ( join , PathScopeExpression . ANY , merge ) ; this . arc ( split , PathScopeExpression . NO_CAPTURE , merge ) ; this . arc ( merge , PathScopeExpression . ANY , sink ) ; } }