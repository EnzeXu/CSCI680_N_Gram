public class HadoopCoGroupGate extends HadoopGroupGate { IndexTuple keyTuple = new KeyIndexTuple(); IndexTuple valueTuple = new ValueIndexTuple(); public HadoopCoGroupGate( FlowProcess flowProcess, CoGroup coGroup, IORole role ) { super( flowProcess, coGroup, role ); } @Override public void bind( StreamGraph streamGraph ) { super.bind( streamGraph ); } @Override protected HadoopCoGroupClosure createClosure() { return new HadoopCoGroupClosure( flowProcess, splice.getNumSelfJoins(), keyFields, valuesFields ); } @Override protected void wrapGroupingAndCollect( Duct previous, int ordinal, Tuple valuesTuple, Tuple groupKey ) throws java.io.IOException { keyTuple.setIndex( ordinal ); keyTuple.setTuple( groupKey ); valueTuple.setIndex( ordinal ); valueTuple.setTuple( valuesTuple ); collector.collect( keyTuple, valueTuple ); } @Override protected Tuple unwrapGrouping( Tuple key ) { return ( (IndexTuple) key ).getTuple(); } protected OutputCollector createOutputCollector() { return ( (HadoopFlowProcess) flowProcess ).getOutputCollector(); } }