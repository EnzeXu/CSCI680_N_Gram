public class VolumePreference extends DialogPreference { private int mVolume = ( int ) ( PreferenceConstants . DEFAULT_BELL_VOLUME * 100 ) ; public VolumePreference ( Context context ) { this ( context , null ) ; } public VolumePreference ( Context context , AttributeSet attrs ) { this ( context , attrs , androidx . preference . R . attr . dialogPreferenceStyle ) ; } public VolumePreference ( Context context , AttributeSet attrs , int defStyleAttr ) { this ( context , attrs , defStyleAttr , defStyleAttr ) ; } public VolumePreference ( Context context , AttributeSet attrs , int defStyleAttr , int defStyleRes ) { super ( context , attrs , defStyleAttr , defStyleRes ) ; setPersistent ( true ) ; } @ Override public int getDialogLayoutResource ( ) { return R . layout . volume_preference_dialog_layout ; } @ Override protected Object onGetDefaultValue ( TypedArray a , int index ) { return a . getInt ( index , 100 ) ; } @ Override protected void onSetInitialValue ( boolean restorePersistedValue , Object defaultValue ) { setVolume ( restorePersistedValue ? ( int ) ( getPersistedFloat ( mVolume ) * 100 ) : ( int ) defaultValue ) ; } public int getVolume ( ) { return mVolume ; } public void setVolume ( int volume ) { mVolume = volume ; persistFloat ( mVolume / 100f ) ; } }