public class GroupingSortingPartitioner extends HasherPartitioner implements org . apache . tez . runtime . library . api . Partitioner { public GroupingSortingPartitioner ( Configuration configuration ) { setConf ( configuration ) ; } public int getPartition ( Object key , Object value , int numReduceTasks ) { return ( hashCode ( ( ( TuplePair ) key ) . getLhs ( ) ) & Integer . MAX_VALUE ) % numReduceTasks ; } }