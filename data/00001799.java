public class HadoopTupleEntrySchemeIterator extends TupleEntrySchemeIterator < Configuration , RecordReader > { private MeasuredRecordReader measuredRecordReader ; public HadoopTupleEntrySchemeIterator ( FlowProcess < ? extends Configuration > flowProcess , Tap parentTap , RecordReader recordReader ) throws IOException { this ( flowProcess , parentTap , parentTap . getScheme ( ) , makeIterator ( flowProcess , parentTap , recordReader ) ) ; } @ Deprecated public HadoopTupleEntrySchemeIterator ( FlowProcess < ? extends Configuration > flowProcess , Scheme scheme , CloseableIterator < RecordReader > closeableIterator ) { super ( flowProcess , scheme , closeableIterator , flowProcess . getStringProperty ( FileType . CASCADING_SOURCE_PATH ) ) ; } public HadoopTupleEntrySchemeIterator ( FlowProcess < ? extends Configuration > flowProcess , Tap tap , Scheme scheme , CloseableIterator < RecordReader > closeableIterator ) { super ( flowProcess , tap , scheme , closeableIterator , flowProcess . getStringProperty ( FileType . CASCADING_SOURCE_PATH ) ) ; } private static CloseableIterator < RecordReader > makeIterator ( FlowProcess < ? extends Configuration > flowProcess , Tap parentTap , RecordReader recordReader ) throws IOException { if ( recordReader != null ) return new RecordReaderIterator ( recordReader ) ; return new MultiRecordReaderIterator ( flowProcess , parentTap ) ; } @ Override protected RecordReader wrapInput ( RecordReader recordReader ) { if ( measuredRecordReader == null ) measuredRecordReader = new MeasuredRecordReader ( getFlowProcess ( ) , SliceCounters . Read_Duration ) ; measuredRecordReader . setRecordReader ( super . wrapInput ( recordReader ) ) ; return measuredRecordReader ; } }