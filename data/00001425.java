public class TupleChainIterable implements Iterable<Tuple>, Resettable<Iterable<Tuple>> { Iterable<Tuple>[] iterables; public TupleChainIterable( Iterable<Tuple> first, Iterable<Tuple>... iterables ) { Iterable<Tuple>[] initial; if( first instanceof TupleChainIterable ) initial = ( (TupleChainIterable) first ).iterables; else initial = new Iterable[]{first}; this.iterables = new Iterable[ initial.length + iterables.length ]; System.arraycopy( initial, 0, this.iterables, 0, initial.length ); System.arraycopy( iterables, 0, this.iterables, initial.length, iterables.length ); } @Override public Iterator<Tuple> iterator() { Iterator<Tuple>[] iterators = new Iterator[ iterables.length ]; for( int i = 0; i < iterables.length; i++ ) iterators[ i ] = iterables[ i ].iterator(); return new TupleChainIterator( iterators ); } @Override public void reset( Iterable<Tuple>... iterables ) { this.iterables = iterables; } }