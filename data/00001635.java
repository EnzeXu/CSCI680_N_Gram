public class Hadoop3MRPlanner extends HadoopPlanner { private static final Logger LOG = LoggerFactory . getLogger ( Hadoop3MRPlanner . class ) ; public static final String PLATFORM_NAME = "hadoop3-mr1" ; public static void copyConfiguration ( Map < Object , Object > properties , Configuration configuration ) { for ( Map . Entry < String , String > entry : configuration ) properties . put ( entry . getKey ( ) , entry . getValue ( ) ) ; } public static void copyProperties ( Configuration configuration , Map < Object , Object > properties ) { if ( properties instanceof Properties ) { Properties props = ( Properties ) properties ; Set < String > keys = props . stringPropertyNames ( ) ; for ( String key : keys ) configuration . set ( key , props . getProperty ( key ) ) ; } else { for ( Map . Entry < Object , Object > entry : properties . entrySet ( ) ) { if ( entry . getValue ( ) != null ) configuration . set ( entry . getKey ( ) . toString ( ) , entry . getValue ( ) . toString ( ) ) ; } } } @ Override public PlannerInfo getPlannerInfo ( String registryName ) { return new PlannerInfo ( getClass ( ) . getSimpleName ( ) , PLATFORM_NAME , registryName ) ; } @ Override protected void checkPlatform ( Configuration conf ) { if ( !HadoopUtil . isYARN ( conf ) ) LOG . warn ( "running Hadoop 1 . x based flows on YARN may cause problems , please use the 'cascading-hadoop' dependencies" ) ; } }