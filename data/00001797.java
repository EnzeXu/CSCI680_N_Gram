public class BalanceGroupSplitJoinExpression extends RuleExpression { public static final FlowElementExpression SHARED_GROUP = new FlowElementExpression( Group.class ); public static final ElementExpression SHARED_JOIN = or( new FlowElementExpression( HashJoin.class ), new FlowElementExpression( Group.class ), new FlowElementExpression( Tap.class ) ); public BalanceGroupSplitJoinExpression() { super( new SyncPipeExpressionGraph(), new ExpressionGraph() .arcs( SHARED_GROUP, SHARED_JOIN ) .arcs( SHARED_GROUP, SHARED_JOIN ), new ExpressionGraph() .arcs( new FlowElementExpression( ElementCapture.Primary, Pipe.class, TypeExpression.Topo.SplitOnly ) ) ); } }