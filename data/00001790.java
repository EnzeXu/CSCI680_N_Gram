public class BalanceHashJoinSameSourceExpression extends RuleExpression { public BalanceHashJoinSameSourceExpression() { super( new SyncPipeExpressionGraph(), new ExpressionGraph() .arc( new FlowElementExpression( ElementCapture.Primary, Tap.class, TypeExpression.Topo.SplitOnly ), JoinEdgesSameSourceScopeExpression.ALL_SAME_SOURCE, new FlowElementExpression( HashJoin.class ) ), new ExpressionGraph() .arc( new FlowElementExpression( ElementCapture.Secondary, Pipe.class ), PathScopeExpression.BLOCKING, new FlowElementExpression( ElementCapture.Primary, HashJoin.class ) ) ); } }