public class TestHashJoinSameSourceExpression extends RuleExpression { private static final FlowElementExpression SHARED_TAP = new FlowElementExpression( Tap.class, TypeExpression.Topo.SplitOnly ); public static final FlowElementExpression SHARED_HASHJOIN = new FlowElementExpression( HashJoin.class ); public TestHashJoinSameSourceExpression() { super( new SyncPipeExpressionGraph(), new ExpressionGraph() .arcs( SHARED_TAP, SHARED_HASHJOIN ) .arcs( SHARED_TAP, SHARED_HASHJOIN ), new ExpressionGraph() .arc( new FlowElementExpression( ElementCapture.Primary, Pipe.class ), PathScopeExpression.BLOCKING, new FlowElementExpression( ElementCapture.Secondary, HashJoin.class ) ) ); } }