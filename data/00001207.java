public class BalanceGroupSplitHashJoinExpression extends RuleExpression { public static final FlowElementExpression SHARED_GROUP = new FlowElementExpression( Group.class ); public BalanceGroupSplitHashJoinExpression() { super( new SyncPipeExpressionGraph(), new ExpressionGraph() .arcs( SHARED_GROUP, new FlowElementExpression( HashJoin.class ) ) .arcs( SHARED_GROUP, new FlowElementExpression( HashJoin.class ) ), new ExpressionGraph() .arcs( new FlowElementExpression( ElementCapture.Primary, Pipe.class, TypeExpression.Topo.SplitOnly ) ) ); } }