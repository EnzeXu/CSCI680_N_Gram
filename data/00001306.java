public class FlowRuntimeProps extends Props { public static final String GATHER_PARTITIONS = "cascading . flow . runtime . gather . partitions . num" ; public static final String LOG_COUNTERS = "cascading . flow . runtime . log . counters" ; public static final String COMBINE_SPLITS = "cascading . flow . runtime . splits . combine" ; int gatherPartitions = 0 ; Set < String > logCounters = new LinkedHashSet < > ( ) ; Boolean combineSplits ; public static FlowRuntimeProps flowRuntimeProps ( ) { return new FlowRuntimeProps ( ) ; } public FlowRuntimeProps ( ) { } public int getGatherPartitions ( ) { return gatherPartitions ; } public FlowRuntimeProps setGatherPartitions ( int gatherPartitions ) { if ( gatherPartitions < 1 ) throw new IllegalArgumentException ( "gatherPartitions value must be greater than zero" ) ; this . gatherPartitions = gatherPartitions ; return this ; } public FlowRuntimeProps addLogCounter ( Enum counter ) { addLogCounter ( counter . getDeclaringClass ( ) . getName ( ) , counter . name ( ) ) ; return this ; } public FlowRuntimeProps addLogCounter ( String group , String counter ) { logCounters . add ( group + " : " + counter ) ; return this ; } public Boolean getCombineSplits ( ) { return combineSplits ; } public FlowRuntimeProps setCombineSplits ( Boolean combineSplits ) { this . combineSplits = combineSplits ; return this ; } @ Override protected void addPropertiesTo ( Properties properties ) { if ( gatherPartitions > 0 ) properties . setProperty ( GATHER_PARTITIONS , Integer . toString ( gatherPartitions ) ) ; if ( !logCounters . isEmpty ( ) ) properties . setProperty ( LOG_COUNTERS , Util . join ( logCounters , " , " ) ) ; if ( combineSplits != null ) properties . setProperty ( COMBINE_SPLITS , Boolean . toString ( combineSplits ) ) ; } }