public class HashJoinMergeIntoHashJoinStreamedStreamedMergeGraph extends FlowElementGraph { public HashJoinMergeIntoHashJoinStreamedStreamedMergeGraph ( ) { Map sources = new HashMap ( ) ; sources . put ( "lower" , new NonTap ( "lower" , new Fields ( "offset" , "line" ) ) ) ; sources . put ( "upper" , new NonTap ( "upper" , new Fields ( "offset" , "line" ) ) ) ; sources . put ( "offset" , new NonTap ( "offset" , new Fields ( "offset" , "line" ) ) ) ; Map sinks = new HashMap ( ) ; sinks . put ( "sink" , new NonTap ( "sink" , new Fields ( "offset" , "line" ) ) ) ; Pipe pipeLower = new Each ( new Pipe ( "lower" ) , new Fields ( "line" ) , new RegexSplitter ( new Fields ( "num1" , "char1" ) , " " ) ) ; Pipe pipeUpper = new Each ( new Pipe ( "upper" ) , new Fields ( "line" ) , new RegexSplitter ( new Fields ( "num1" , "char1" ) , " " ) ) ; Pipe pipeOffset = new Each ( new Pipe ( "offset" ) , new Fields ( "line" ) , new RegexSplitter ( new Fields ( "num2" , "char2" ) , " " ) ) ; Pipe splice = new HashJoin ( pipeLower , new Fields ( "num1" ) , pipeOffset , new Fields ( "num2" ) ) ; splice = new Retain ( splice , new Fields ( "num1" , "char1" ) ) ; splice = new Merge ( "merge1" , splice , pipeUpper ) ; splice = new HashJoin ( splice , new Fields ( "num1" ) , pipeOffset , new Fields ( "num2" ) ) ; splice = new Retain ( splice , new Fields ( "num1" , "char1" ) ) ; splice = new Merge ( "merge2" , splice , pipeUpper ) ; splice = new HashJoin ( splice , new Fields ( "num1" ) , pipeOffset , new Fields ( "num2" ) ) ; splice = new Pipe ( "sink" , splice ) ; initialize ( sources , sinks , splice ) ; } }