public class ScalaTestCompileMojo extends ScalaCompilerSupport { @Parameter(property = "maven.test.skip") private boolean skip; @Parameter(defaultValue = "${project.build.testOutputDirectory}") private File testOutputDir; @Parameter(defaultValue = "${project.build.testSourceDirectory}/../scala") private File testSourceDir; @Override public void execute() throws MojoExecutionException, MojoFailureException { if (skip) { getLog().info("Not compiling test sources"); return; } super.execute(); } @Parameter( property = "testAnalysisCacheFile", defaultValue = "${project.build.directory}/analysis/test-compile") private File testAnalysisCacheFile; @Override protected Set<File> getClasspathElements() throws Exception { Set<File> back = FileUtils.fromStrings(project.getTestClasspathElements()); back.remove(new File(project.getBuild().getTestOutputDirectory())); addAdditionalDependencies(back); return back; } @Override protected List<Dependency> getDependencies() { return project.getTestDependencies(); } @Override protected File getOutputDir() { return testOutputDir.getAbsoluteFile(); } @Override protected List<File> getSourceDirectories() throws Exception { List<String> sources = project.getTestCompileSourceRoots(); String scalaSourceDir = testSourceDir.getAbsolutePath(); if (!sources.contains(scalaSourceDir)) { sources.add(scalaSourceDir); } return normalize(sources); } @Override protected File getAnalysisCacheFile() { return testAnalysisCacheFile.getAbsoluteFile(); } }