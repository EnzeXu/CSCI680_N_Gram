public class CrossTab extends SubAssembly { private static final long serialVersionUID = 1L ; public CrossTab ( Pipe previous , Fields argumentFieldSelector , CrossTabOperation crossTabOperation , Fields fieldDeclaration ) { super ( previous ) ; Pipe pipe = new Each ( previous , argumentFieldSelector , new Identity ( new Fields ( "n" , "l" , "v" ) ) ) ; pipe = new CoGroup ( pipe , new Fields ( "l" ) , 1 , new Fields ( "n1" , "l" , "v1" , "n2" , "l2" , "v2" ) ) ; pipe = new Each ( pipe , new Fields ( "l" , "n1" , "v1" , "n2" , "v2" ) , new Identity ( ) ) ; pipe = new Each ( pipe , new RegexFilter ( "^ [ ^\\t ] *\\t ( [ ^\\t ] * ) \\t [ ^\\t ] *\\t\\1\\t . *" , true ) ) ; pipe = new Each ( pipe , new SortElements ( new Fields ( "n1" , "v1" ) , new Fields ( "n2" , "v2" ) ) ) ; pipe = new GroupBy ( pipe , Fields . ALL ) ; pipe = new Every ( pipe , Fields . ALL , new First ( ) , Fields . RESULTS ) ; pipe = new GroupBy ( pipe , new Fields ( "n1" , "n2" ) ) ; pipe = new Every ( pipe , new Fields ( "v1" , "v2" ) , crossTabOperation ) ; pipe = new Each ( pipe , new Identity ( fieldDeclaration ) ) ; setTails ( pipe ) ; } public abstract static class CrossTabOperation < C > extends BaseOperation < C > implements Aggregator < C > { protected CrossTabOperation ( Fields fields ) { super ( fields ) ; } } }