public class JoinEdgesSameSourceScopeExpression extends ScopeExpression { public static final JoinEdgesSameSourceScopeExpression ALL_SAME_SOURCE = new JoinEdgesSameSourceScopeExpression ( ) ; public JoinEdgesSameSourceScopeExpression ( ) { } @ Override public boolean applies ( PlannerContext plannerContext , ElementGraph elementGraph , Scope scope ) { FlowElement edgeSource = elementGraph . getEdgeSource ( scope ) ; FlowElement edgeTarget = elementGraph . getEdgeTarget ( scope ) ; Set < Scope > allEdgesBetween = elementGraph . getAllEdges ( edgeSource , edgeTarget ) ; if ( allEdgesBetween . size ( ) == 1 ) return false ; return allEdgesBetween . equals ( elementGraph . incomingEdgesOf ( edgeTarget ) ) ; } }