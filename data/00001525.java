public class TestWritableComparable implements WritableComparable { private String value ; public TestWritableComparable ( ) { } public TestWritableComparable ( String value ) { this . value = value ; } public void write ( DataOutput dataOutput ) throws IOException { WritableUtils . writeString ( dataOutput , value ) ; } public void readFields ( DataInput dataInput ) throws IOException { value = WritableUtils . readString ( dataInput ) ; } public int compareTo ( Object object ) { return value . compareTo ( object . toString ( ) ) ; } public String toString ( ) { return value ; } public boolean equals ( Object object ) { if ( this == object ) return true ; if ( object == null || getClass ( ) != object . getClass ( ) ) return false ; TestWritableComparable that = ( TestWritableComparable ) object ; if ( value != null ? !value . equals ( that . value ) : that . value != null ) return false ; return true ; } public int hashCode ( ) { return ( value != null ? value . hashCode ( ) : 0 ) ; } }