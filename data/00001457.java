public class FilterEachStage extends EachStage { private Filter filter ; public FilterEachStage ( FlowProcess flowProcess , Each each ) { super ( flowProcess , each ) ; } @ Override protected Fields getIncomingPassThroughFields ( ) { return incomingScopes . get ( 0 ) . getIncomingFunctionPassThroughFields ( ) ; } @ Override protected Fields getIncomingArgumentsFields ( ) { return incomingScopes . get ( 0 ) . getIncomingFunctionArgumentFields ( ) ; } @ Override public void initialize ( ) { super . initialize ( ) ; filter = each . getFilter ( ) ; } @ Override public void receive ( Duct previous , int ordinal , TupleEntry incomingEntry ) { argumentsEntry . setTuple ( argumentsBuilder . makeResult ( incomingEntry . getTuple ( ) , null ) ) ; try { if ( filter . isRemove ( flowProcess , operationCall ) ) return ; next . receive ( this , 0 , incomingEntry ) ; } catch ( CascadingException exception ) { handleException ( exception , argumentsEntry ) ; } catch ( Throwable throwable ) { handleException ( new OperatorException ( each , "operator Each failed executing operation" , throwable ) , argumentsEntry ) ; } } }