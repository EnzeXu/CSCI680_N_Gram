public class BalanceSplitToStreamedHashJoinExpression extends RuleExpression { private static final FlowElementExpression SHARED_SPLIT = new FlowElementExpression ( Pipe . class , TypeExpression . Topo . Split ) ; public static final FlowElementExpression SHARED_HASHJOIN = new FlowElementExpression ( HashJoin . class ) ; public BalanceSplitToStreamedHashJoinExpression ( ) { super ( new ExpressionGraph ( and ( ElementCapture . Primary , not ( and ( new FlowElementExpression ( Pipe . class , TypeExpression . Topo . Split ) , not ( new FlowElementExpression ( Boundary . class ) ) ) ) , not ( new FlowElementExpression ( HashJoin . class ) ) ) ) , new ExpressionGraph ( ) . arcs ( SHARED_SPLIT , SHARED_HASHJOIN ) . arcs ( SHARED_SPLIT , SHARED_HASHJOIN ) , new ExpressionGraph ( ) . arc ( and ( ElementCapture . Secondary , new FlowElementExpression ( Pipe . class ) , not ( new FlowElementExpression ( Boundary . class ) ) ) , PathScopeExpression . NON_BLOCKING , new FlowElementExpression ( ElementCapture . Primary , HashJoin . class ) ) ) ; } }