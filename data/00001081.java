public class MulitStepFlowGraph extends FlowElementGraph { public MulitStepFlowGraph ( ) { Pipe lower = new Pipe ( "lower" ) ; Pipe upper = new Pipe ( "upper" ) ; lower = new Checkpoint ( lower ) ; upper = new Checkpoint ( upper ) ; lower = new Checkpoint ( lower ) ; upper = new Checkpoint ( upper ) ; Pipe sink = new Merge ( "sink" , lower , upper ) ; Map < String , Tap > sources = createHashMap ( ) ; sources . put ( lower . getName ( ) , new NonTap ( new Fields ( "offset" , "line" ) ) ) ; sources . put ( upper . getName ( ) , new NonTap ( new Fields ( "offset" , "line" ) ) ) ; Map < String , Tap > sinks = createHashMap ( ) ; sinks . put ( sink . getName ( ) , new NonTap ( new Fields ( "offset" , "line" ) ) ) ; initialize ( sources , sinks , sink ) ; } }